 -- DATABASE INITIALISATION

USE master
GO

IF EXISTS (SELECT * FROM sysdatabases WHERE NAME='TaskNo2')
	DROP DATABASE [TaskNo2]
GO

DECLARE @device_directory NVARCHAR(520)
SELECT @device_directory = SUBSTRING(filename, 1, CHARINDEX(N'master.mdf', LOWER(filename)) - 1)
FROM master.dbo.sysaltfiles WHERE dbid = 1 AND fileid = 1

--C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA

EXECUTE (N'CREATE DATABASE TaskNo2
  ON PRIMARY (NAME = N''TaskNo2'', FILENAME = N''' + @device_directory + N'TaskNo2.mdf'')
  LOG ON (NAME = N''TaskNo2_log'',  FILENAME = N''' + @device_directory + N'TaskNo2_log.ldf'')')
GO

SET DATEFORMAT ymd
GO

USE [TaskNo2]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CHECK_TRANSACTION]') AND type in (N'P'))
DROP PROCEDURE [dbo].[CHECK_TRANSACTION]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRS-EMP]') AND type in (N'U'))
DROP TABLE [dbo].[TRS-EMP]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRS-PRO]') AND type in (N'U'))
DROP TABLE [dbo].[TRS-PRO]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRS-VEH]') AND type in (N'U'))
DROP TABLE [dbo].[TRS-VEH]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSPORTS]') AND type in (N'U'))
DROP TABLE [dbo].[TRANSPORTS]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CUSTOMERS]') AND type in (N'U'))
DROP TABLE [dbo].[CUSTOMERS]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VEHICLES]') AND type in (N'U'))
DROP TABLE [dbo].[VEHICLES]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LOCATIONS]') AND type in (N'U'))
DROP TABLE [dbo].[LOCATIONS]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PRODUCTS]') AND type in (N'U'))
DROP TABLE [dbo].[PRODUCTS]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BRANDS]') AND type in (N'U'))
DROP TABLE [dbo].[BRANDS]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[COUNTRIES]') AND type in (N'U'))
DROP TABLE [dbo].[COUNTRIES]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EMPLOYEES]') AND type in (N'U'))
DROP TABLE [dbo].[EMPLOYEES]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MODELS]') AND type in (N'U'))
DROP TABLE [dbo].[MODELS]
GO

--DATABASE CREATION

SET ANSI_NULLS ON
GO

CREATE TABLE [dbo].[COUNTRIES](
	[COUNTRY_ID] [int] IDENTITY (1, 1) NOT NULL,
	[COUNTRY_NAME] [varchar](100) NOT NULL,
 CONSTRAINT [PK_COUNTRIES] PRIMARY KEY CLUSTERED ([COUNTRY_ID] ASC)
) ON [PRIMARY]
GO
CREATE UNIQUE INDEX [I_COUNTRY_NAME] ON [dbo].[COUNTRIES]([COUNTRY_NAME])
GO

CREATE TABLE [dbo].[BRANDS](
	[BRAND_ID] [int] IDENTITY (1, 1) NOT NULL,
	[BRAND_NAME] [varchar](100) NOT NULL,
 CONSTRAINT [PK_BRANDS] PRIMARY KEY CLUSTERED ([BRAND_ID] ASC)
) ON [PRIMARY]
GO
CREATE UNIQUE INDEX [I_BRAND_NAME] ON [dbo].[BRANDS]([BRAND_NAME])
GO

CREATE TABLE [dbo].[MODELS](
	[MODEL_ID] [int] IDENTITY (1, 1) NOT NULL,
	[MODEL_NAME] [varchar](100) NOT NULL,
 CONSTRAINT [PK_MODELS] PRIMARY KEY CLUSTERED ([MODEL_ID] ASC) 
) ON [PRIMARY]
GO
CREATE UNIQUE INDEX [I_MODEL_NAME] ON [dbo].[MODELS]([MODEL_NAME])
GO

CREATE TABLE [dbo].[EMPLOYEES](
	[EMPLOYEE_ID] [int] IDENTITY (1, 1) NOT NULL,
	[EMPLOYEE_NAME] [varchar](100) NOT NULL,
	[SUPERVISOR] [int] NULL,
	[LAST_TRIP] [datetime] NULL,
	[IS_AVAILABLE] [bit] DEFAULT (1) NOT NULL,
 CONSTRAINT [PK_EMPLOYEES] PRIMARY KEY CLUSTERED ([EMPLOYEE_ID] ASC),
 CONSTRAINT [FK_EMPLOYEES_EMPLOYEES] FOREIGN KEY([SUPERVISOR]) REFERENCES [dbo].[EMPLOYEES]([EMPLOYEE_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_SUPERVISOR] ON [dbo].[EMPLOYEES]([SUPERVISOR])
GO
CREATE INDEX [I_EMPLOYEE_NAME] ON [dbo].[EMPLOYEES]([EMPLOYEE_NAME])
GO

CREATE TABLE [dbo].[PRODUCTS](
	[PRODUCT_ID] [int] IDENTITY (1, 1) NOT NULL,
	[PRODUCT_NAME] [varchar](100) NOT NULL,
	[CATEGORY] [int] CHECK (CATEGORY >= 1 AND CATEGORY <= 4) NOT NULL,
	[VOLUME] [decimal](18, 0) CHECK (VOLUME > 0) NOT NULL,
	[PRICE] [money] CHECK (PRICE > 0) NOT NULL,
	[DESCRIPTION] [text] NOT NULL,
 CONSTRAINT [PK_PRODUCTS] PRIMARY KEY CLUSTERED ([PRODUCT_ID] ASC)
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
CREATE UNIQUE INDEX [I_PRODUCT_NAME] ON [dbo].[PRODUCTS]([PRODUCT_NAME])
GO
CREATE INDEX [I_VOLUME] ON [dbo].[PRODUCTS]([VOLUME])
GO
CREATE INDEX [I_PRICE] ON [dbo].[PRODUCTS]([PRICE])
GO

CREATE TABLE [dbo].[LOCATIONS](
	[LOCATION_ID] [int] IDENTITY (1, 1) NOT NULL,
	[COUNTRY_ID] [int] NOT NULL,
	[CITY] [varchar](100) NOT NULL,
	[ZIP_CODE] [varchar](100) NOT NULL,
	[STREET] [varchar](100) NULL,
	[HOUSE_NUMBER] [varchar](100) NOT NULL,
 CONSTRAINT [PK_LOCATIONS] PRIMARY KEY CLUSTERED ([LOCATION_ID] ASC),
 CONSTRAINT [FK_LOCATIONS_COUNTRIES] FOREIGN KEY([COUNTRY_ID]) REFERENCES [dbo].[COUNTRIES]([COUNTRY_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_COUNTRY_ID] ON [dbo].[LOCATIONS]([COUNTRY_ID])
GO

CREATE TABLE [dbo].[VEHICLES](
	[VIN] [char](17) NOT NULL,
	[BRAND_ID] [int] NOT NULL,
	[MODEL_ID] [int] NOT NULL,
	[MAX_LOAD] [decimal](18, 0) NOT NULL,
	[EMPLOYEE_ID] [int] NOT NULL,
 CONSTRAINT [PK_VEHICLES] PRIMARY KEY CLUSTERED ([VIN] ASC),
 CONSTRAINT [FK_VEHICLES_BRANDS] FOREIGN KEY([BRAND_ID]) REFERENCES [dbo].[BRANDS]([BRAND_ID]),
 CONSTRAINT [FK_VEHICLES_MODELS] FOREIGN KEY([MODEL_ID]) REFERENCES [dbo].[MODELS]([MODEL_ID]),
 CONSTRAINT [FK_VEHICLES_EMPLOYEES] FOREIGN KEY([EMPLOYEE_ID]) REFERENCES [dbo].[EMPLOYEES]([EMPLOYEE_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_BRAND_ID] ON [dbo].[VEHICLES]([BRAND_ID])
GO
CREATE INDEX [I_MODEL_ID] ON [dbo].[VEHICLES]([MODEL_ID])
GO
CREATE INDEX [I_EMPLOYEE_ID_VEHICLES] ON [dbo].[VEHICLES]([EMPLOYEE_ID])
GO

CREATE TABLE [dbo].[CUSTOMERS](
	[CUSTOMER_ID] [int] IDENTITY (1, 1) NOT NULL,
	[CUSTOMER_NAME] [varchar](100) NOT NULL,
	[LOCATION_ID] [int] NOT NULL,
	[PHONE_NUMBER] [varchar](100) NOT NULL,
	[EMAIL] [varchar](100) NULL,
 CONSTRAINT [PK_CUSTOMERS] PRIMARY KEY CLUSTERED ([CUSTOMER_ID] ASC),
 CONSTRAINT [FK_CUSTOMERS_LOCATIONS] FOREIGN KEY([LOCATION_ID]) REFERENCES [dbo].[LOCATIONS]([LOCATION_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_CUSTOMER_NAME] ON [dbo].[CUSTOMERS]([CUSTOMER_NAME])
GO
CREATE INDEX [I_LOCATION_ID] ON [dbo].[CUSTOMERS]([LOCATION_ID])
GO
CREATE UNIQUE INDEX [I_PHONE_NUMBER] ON [dbo].[CUSTOMERS]([PHONE_NUMBER])
GO

CREATE TABLE [dbo].[TRANSPORTS](
	[TRANSPORT_ID] [int] IDENTITY (1, 1) NOT NULL,
	[CUSTOMER_ID] [int] NOT NULL,
	[SOURCE_ID] [int] NOT NULL,
	[TARGET_ID] [int] NOT NULL,
	[PICKUP_TIME] [datetime] NOT NULL,
	[IS_DELAYED] [bit] DEFAULT (0) NOT NULL,
	[HAS_STARTED] [bit] DEFAULT (0) NOT NULL,
	[HAS_FINISHED] [bit] DEFAULT (0) NOT NULL,
 CONSTRAINT [PK_TRANSPORTS] PRIMARY KEY NONCLUSTERED ([TRANSPORT_ID] ASC),
 CONSTRAINT [FK_TRANSPORTS_CUSTOMERS] FOREIGN KEY([CUSTOMER_ID]) REFERENCES [dbo].[CUSTOMERS]([CUSTOMER_ID]),
 CONSTRAINT [FK_TRANSPORTS_LOCATIONS_SOURCE] FOREIGN KEY([SOURCE_ID]) REFERENCES [dbo].[LOCATIONS]([LOCATION_ID]),
 CONSTRAINT [FK_TRANSPORTS_LOCATIONS_TARGET] FOREIGN KEY([TARGET_ID]) REFERENCES [dbo].[LOCATIONS]([LOCATION_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_CUSTOMER_ID] ON [dbo].[TRANSPORTS]([CUSTOMER_ID])
GO
CREATE INDEX [I_SOURCE_ID] ON [dbo].[TRANSPORTS]([SOURCE_ID])
GO
CREATE INDEX [I_TARGET_ID] ON [dbo].[TRANSPORTS]([TARGET_ID])
GO

CREATE TABLE [dbo].[TRS-VEH](
	[TRANSPORT_ID] [int] NOT NULL,
	[VIN] [char](17) NOT NULL,
	[DRIVE_LAUNCH] [datetime] NULL,
	[DRIVE_FINISH] [datetime] NULL,
	[DISTANCE] [decimal](18, 0) DEFAULT (0) NOT NULL,
 CONSTRAINT [PK_TRS-VEH] PRIMARY KEY NONCLUSTERED(
		[TRANSPORT_ID],
		[VIN]),
 CONSTRAINT [FK_TRS-VEH_TRANSPORTS] FOREIGN KEY([TRANSPORT_ID]) REFERENCES [dbo].[TRANSPORTS]([TRANSPORT_ID]),
 CONSTRAINT [FK_TRS-VEH_VEHICLES] FOREIGN KEY([VIN]) REFERENCES [dbo].[VEHICLES]([VIN])
) ON [PRIMARY]
GO
CREATE INDEX [I_TRANSPORT_ID_TRS-VEH] ON [dbo].[TRS-VEH]([TRANSPORT_ID])
GO
CREATE INDEX [I_VIN_TRS-VEH] ON [dbo].[TRS-VEH]([VIN])
GO
CREATE INDEX [I_DISTANCE] ON [dbo].[TRS-VEH]([DISTANCE])
GO

CREATE TABLE [dbo].[TRS-PRO](
	[TRANSPORT_ID] [int] NOT NULL,
	[PRODUCT_ID] [int] NOT NULL,
	[AMOUNT] [int] CHECK (AMOUNT > 0) NOT NULL,
 CONSTRAINT [PK_TRS-PRO] PRIMARY KEY NONCLUSTERED(
		[TRANSPORT_ID],
		[PRODUCT_ID]),
 CONSTRAINT [FK_TRS-PRO_TRANSPORTS] FOREIGN KEY([TRANSPORT_ID]) REFERENCES [dbo].[TRANSPORTS]([TRANSPORT_ID]),
 CONSTRAINT [FK_TRS-PRO_PRODUCTS] FOREIGN KEY([PRODUCT_ID]) REFERENCES [dbo].[PRODUCTS]([PRODUCT_ID]),
) ON [PRIMARY]
GO
CREATE INDEX [I_TRANSPORT_ID_TRS-PRO] ON [dbo].[TRS-PRO]([TRANSPORT_ID])
GO
CREATE INDEX [I_PRODUCT_ID] ON [dbo].[TRS-PRO]([PRODUCT_ID])
GO
CREATE INDEX [I_AMOUNT] ON [dbo].[TRS-PRO]([AMOUNT])
GO

CREATE TABLE [dbo].[TRS-EMP](
	[TRANSPORT_ID] [int] NOT NULL,
	[VIN] [char](17) NOT NULL,
	[EMPLOYEE_ID] [int] NOT NULL,
 CONSTRAINT [PK_TRS-EMP] PRIMARY KEY NONCLUSTERED(
		[TRANSPORT_ID],
		[VIN],
		[EMPLOYEE_ID]),
 CONSTRAINT [FK_TRS-EMP_TRS-VEH] FOREIGN KEY([TRANSPORT_ID], [VIN]) REFERENCES [dbo].[TRS-VEH]([TRANSPORT_ID], [VIN]),
 CONSTRAINT [FK_TRS-EMP_EMPLOYEES] FOREIGN KEY([EMPLOYEE_ID]) REFERENCES [dbo].[EMPLOYEES]([EMPLOYEE_ID])
) ON [PRIMARY]
GO
CREATE INDEX [I_TRANSPORT_ID_TRS-EMP] ON [dbo].[TRS-EMP]([TRANSPORT_ID], [VIN])
GO
CREATE INDEX [I_EMPLOYEE_ID_TRS-EMP] ON [dbo].[TRS-EMP]([EMPLOYEE_ID])
GO

--DATABASE INSERTION

SET IDENTITY_INSERT [dbo].[COUNTRIES] ON
INSERT INTO [dbo].[COUNTRIES]([COUNTRY_ID], [COUNTRY_NAME])
VALUES
(1, 'Poland'),
(2, 'Macedonia'),
(3, 'France'),
(4, 'Belgium'),
(5, 'United Kingdom'),
(6, 'Spain')
SET IDENTITY_INSERT [dbo].[COUNTRIES] OFF
GO

SET IDENTITY_INSERT [dbo].[BRANDS] ON
INSERT INTO [dbo].[BRANDS]([BRAND_ID], [BRAND_NAME])
VALUES
(1, 'Scania'),
(2, 'MAN'),
(3, 'Reanult'),
(4, 'Mercedes'),
(5, 'Peugeot')
SET IDENTITY_INSERT [dbo].[BRANDS] OFF
GO

SET IDENTITY_INSERT [dbo].[MODELS] ON
INSERT INTO [dbo].[MODELS]([MODEL_ID], [MODEL_NAME])
VALUES
(1, 'Car'),
(2, 'Van'),
(3, 'Semi-truck'),
(4, 'Truck'),
(5, 'Trailer')
SET IDENTITY_INSERT [dbo].[MODELS] OFF
GO

SET IDENTITY_INSERT [dbo].[EMPLOYEES] ON
INSERT INTO [dbo].[EMPLOYEES]([EMPLOYEE_ID], [EMPLOYEE_NAME], [SUPERVISOR], [LAST_TRIP], [IS_AVAILABLE])
VALUES
(1, 'Adam Jablonski', NULL, NULL, 1),
(2, 'Andrzej Wachowicz', 1, NULL, 1),
(3, 'Krystian Nowak', 1, '2021-05-11 22:27:15', 1),
(4, 'Tomasz Piekarski', 2, '2021-05-19 16:41:04', 1),
(5, 'Waclaw Pietka', 2, '2021-05-20 07:13:23', 1),
(6, 'Maciej Kowalski', 3, '2021-05-15 09:40:06', 1),
(7, 'Radoslaw Szczypek', 3, '2021-05-21 17:35:09', 1),
(8, 'Paulina Wojcik', 3, '2021-05-20 07:13:23', 1)
SET IDENTITY_INSERT [dbo].[EMPLOYEES] OFF
GO

SET IDENTITY_INSERT [dbo].[PRODUCTS] ON
INSERT INTO [dbo].[PRODUCTS]([PRODUCT_ID], [PRODUCT_NAME], [CATEGORY], [VOLUME], [PRICE], [DESCRIPTION])
VALUES
(1, 'Table', 3, 100, 500, 'A glass table.'),
(2, 'Chair', 1, 40, 200, 'A chair that matches the table.'),
(3, 'Bed', 2, 400, 1200, 'A comfortable bed.'),
(4, 'Sofa', 2, 800, 2500, 'A stylish sofa.'),
(5, 'Wardrobe', 4, 500, 1600, 'A wardrobe with glass doors.')
SET IDENTITY_INSERT [dbo].[PRODUCTS] OFF
GO

INSERT INTO [dbo].[VEHICLES]([VIN], [BRAND_ID], [MODEL_ID], [MAX_LOAD], [EMPLOYEE_ID])
VALUES
('2FALP71W8TX160353', 3, 1, 250, 8),
('1GCGK13U85F930679', 4, 2, 800, 4),
('3D7MX48AX7G823032', 1, 3, 1200, 5),
('3GCEC14X06G175122', 1, 4, 5000, 6),
('WAUFGAFC2EN138014', 2, 5, 6000, 7)
GO

SET IDENTITY_INSERT [dbo].[LOCATIONS] ON
INSERT INTO [dbo].[LOCATIONS]([LOCATION_ID], [COUNTRY_ID], [CITY], [ZIP_CODE], [STREET], [HOUSE_NUMBER])
VALUES
(1, 6, 'Castuera', '06420', 'Los Herran', '98'),
(2, 1, 'Poznan', '60-121', 'Glogowska', '120'),
(3, 4, 'Linter', '3350', 'Rue du Chateau', '35A'),
(4, 3, 'Lyon', '69004', 'rue de la République', '45'),
(5, 5, 'Tixover', 'PE9 1UF', 'Ploughley Road', '56')
SET IDENTITY_INSERT [dbo].[LOCATIONS] OFF
GO

SET IDENTITY_INSERT [dbo].[CUSTOMERS] ON
INSERT INTO [dbo].[CUSTOMERS]([CUSTOMER_ID], [CUSTOMER_NAME], [LOCATION_ID], [PHONE_NUMBER], [EMAIL])
VALUES
(1, 'Octaviano Sevilla', 1, '+34 771 362 263', NULL),
(2, 'Boleslawa Kalinowska', 2, '+48 784-936-231', 'kalinowskab@outlook.com'),
(3, 'Ayah Beverdam', 3, '+32 0470 13 87268', 'ayah25@gmail.com'),
(4, 'Amber Desilets', 4, '+33 04.57.17.40025', NULL),
(5, 'Linda Vincent', 5, '+44 077 2128 5326', 'lindavin@hotmail.com')
SET IDENTITY_INSERT [dbo].[CUSTOMERS] OFF
GO

SET IDENTITY_INSERT [dbo].[TRANSPORTS] ON
INSERT INTO [dbo].[TRANSPORTS]([TRANSPORT_ID], [SOURCE_ID], [TARGET_ID], [CUSTOMER_ID], [PICKUP_TIME], [IS_DELAYED], [HAS_STARTED], [HAS_FINISHED])
VALUES
(1, 1, 4, 1, '2021-05-07 11:34:48', 0, 1, 1),
(2, 1, 3, 1, '2021-05-08 06:57:18', 0, 1, 1),
(3, 2, 1, 2, '2021-05-09 18:17:27', 0, 1, 1),
(4, 5, 1, 5, '2021-05-12 04:34:30', 0, 1, 1),
(5, 2, 3, 2, '2021-05-13 15:21:17', 0, 1, 1),
(6, 2, 4, 2, '2021-05-13 07:23:44', 0, 1, 1),
(7, 5, 2, 5, '2021-05-16 22:17:08', 0, 1, 1),
(8, 3, 5, 3, '2021-05-18 12:20:04', 0, 1, 1),
(9, 4, 3, 4, '2021-05-19 09:42:39', 0, 1, 1),
(10, 4, 5, 4, '2021-05-22 15:48:05', 0, 1, 1)
SET IDENTITY_INSERT [dbo].[TRANSPORTS] OFF
GO

INSERT INTO [dbo].[TRS-PRO]([TRANSPORT_ID], [PRODUCT_ID], [AMOUNT])
VALUES
(1, 4, 2),
(1, 3, 3),
(1, 5, 2),
(2, 1, 1),
(2, 2, 2),
(3, 1, 2),
(3, 2, 8),
(4, 2, 1),
(5, 4, 1),
(6, 1, 1),
(6, 3, 2),
(6, 5, 1),
(7, 1, 1),
(7, 4, 1),
(8, 4, 4),
(8, 5, 4),
(9, 3, 1),
(9, 4, 1),
(9, 5, 1),
(10, 1, 2),
(10, 3, 1)
GO

INSERT INTO [dbo].[TRS-VEH]([TRANSPORT_ID], [VIN], [DRIVE_LAUNCH], [DRIVE_FINISH], [DISTANCE])
VALUES
(1, 'WAUFGAFC2EN138014', '2021-05-07 11:34:48', '2021-05-07 18:37:29', 483),
(1, '3GCEC14X06G175122', '2021-05-08 09:01:25', '2021-05-10 13:51:22', 2843), -- 8h
(2, '2FALP71W8TX160353', '2021-05-08 06:57:18', '2021-05-08 13:12:49', 226),
(3, '3D7MX48AX7G823032', '2021-05-09 18:17:27', '2021-05-11 22:27:15', 941), -- 8h
(3, '1GCGK13U85F930679', '2021-05-12 03:05:32', '2021-05-12 08:53:02', 387),
(4, '2FALP71W8TX160353', '2021-05-12 04:34:30', '2021-05-12 09:18:23', 458),
(5, '1GCGK13U85F930679', '2021-05-13 15:21:17', '2021-05-13 18:22:54', 732),
(6, 'WAUFGAFC2EN138014', '2021-05-13 07:23:44', '2021-05-14 01:46:10', 1940), -- 8h
(6, '3GCEC14X06G175122', '2021-05-14 08:42:38', '2021-05-14 15:13:37', 184),
(6, '3D7MX48AX7G823032', '2021-05-15 06:25:57', '2021-05-15 09:40:06', 825),
(7, '3D7MX48AX7G823032', '2021-05-16 22:17:08', '2021-05-17 05:46:45', 1698), -- 8h
(8, 'WAUFGAFC2EN138014', '2021-05-18 12:20:04', '2021-05-20 07:13:23', 471),
(9, '3GCEC14X06G175122', '2021-05-19 09:42:39', '2021-05-19 16:41:04', 642),
(9, 'WAUFGAFC2EN138014', '2021-05-21 11:16:21', '2021-05-21 17:35:09', 277),
(10, '1GCGK13U85F930679', '2021-05-22 15:48:05', '2021-05-22 23:28:41', 350)
GO

INSERT INTO [dbo].[TRS-EMP]([TRANSPORT_ID], [VIN], [EMPLOYEE_ID])
VALUES
(1, 'WAUFGAFC2EN138014', 7),
(1, '3GCEC14X06G175122', 5), -- 8h
(1, '3GCEC14X06G175122', 6), -- 8h
(2, '2FALP71W8TX160353', 4),
(3, '3D7MX48AX7G823032', 3), -- 8h
(3, '3D7MX48AX7G823032', 8), -- 8h
(3, '1GCGK13U85F930679', 5),
(4, '2FALP71W8TX160353', 7),
(5, '1GCGK13U85F930679', 8),
(6, 'WAUFGAFC2EN138014', 4), -- 8h
(6, 'WAUFGAFC2EN138014', 6), -- 8h
(6, '3GCEC14X06G175122', 5),
(6, '3D7MX48AX7G823032', 8),
(7, '3D7MX48AX7G823032', 6), -- 8h
(7, '3D7MX48AX7G823032', 7), -- 8h
(8, 'WAUFGAFC2EN138014', 5),
(9, '3GCEC14X06G175122', 4),
(9, 'WAUFGAFC2EN138014', 7),
(10, '1GCGK13U85F930679', 6)
GO